Version 1.3
improved type safety, commented some code